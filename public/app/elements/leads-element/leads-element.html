<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../../bower_components/paper-material/paper-material.html">
<link rel="import" href="../../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../../bower_components/paper-input/paper-input.html">
<link rel="import" href="../../../bower_components/iron-flex-layout/classes/iron-flex-layout.html">
<link rel="import" href="../../../bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="../../../bower_components/paper-dialog/paper-dialog.html">
<link rel="import" href="../../../bower_components/paper-spinner/paper-spinner-lite.html">
<link rel="import" href="../../../bower_components/paper-spinner/paper-spinner.html">
<link rel="import" href="../../../bower_components/neon-animation/neon-animations.html">
<dom-module id="leads-element">
    <template>
        <style>
        :host {
            display: block;
        }
        
        .container {
            @apply(--layout-horizontal);
            @apply(--layout-center-justified);
            width: 95%;
        }
        
        .indigo {
            background-color: #3F51B5;
            color: white;
            margin-top: 1%;
            --paper-button-raised-keyboard-focus: {
                background-color: var(--paper-pink-a200) !important;
                color: white !important;
                margin-left: 10px;
            }
            ;
        }
        
        .indigo:hover {
            background-color: #354497;
        }
        
        #signin-paper {
            padding: 10%;
            border-radius: 2px;
            background: white;
        }
        
        #registerbutton {
            width: 50%;
            margin-bottom: 1%;
        }
        
        .okButton {
            background-color: #3b5998;
            color: #ffffff;
        }
        
        .okButton:hover {
            background-color: #324b81;
        }
        
        @media all and (min-width: 0) and (max-width: 800px) and (orientation: portrait) {
            .indigo {
                background-color: #3F51B5;
                color: white;
                margin-top: 1%;
                width: 30%;
                --paper-button-raised-keyboard-focus: {
                    background-color: var(--paper-pink-a200) !important;
                    color: white !important;
                    margin-left: 1%;
                }
            }
            .indigo:hover {
                background-color: #354497;
                border: 1px solid #354497;
            }
            .container {
                @apply(--layout-horizontal);
                @apply(--layout-center-justified);
                margin: -1%;
                padding: 0%;
            }
            #signin-paper {
                padding-left: 20px;
                padding-right: 20px;
                padding-top: 10px;
                border-radius: 2px;
                background: white;
            }
            #registerbutton {
                width: 80%;
                margin-top: 3%;
                margin-bottom: 3%;
            }
            .container > h5 {
                margin-bottom: 3%
            }
            @media all and (min-width: 0) and (max-width: 600px) and (orientation: portrait) {
                .mobHide {
                    display: none;
                }
                #signin-paper {
                    padding: 4px;
                }
            }
        }
        </style>
        <paper-material elevation="2" id="signin-paper">
            <div class="mobHide">
                <div class="container">
                    <h4>Already have an account?</h4>
                </div>
                <div class="container">
                    <paper-button class="okButton" on-tap="signin">Sign In</paper-button>
                </div>
                <div class="container" style="border-bottom:1px solid #3F51B5;">
                    <h5>OR</h5>
                </div>
            </div>
            <div class="container">
                <h4>Register Yourself for Free</h4>
            </div>
            <div class="container">
                <paper-input label="Name" id="registername" class="flex" error-message="Please enter your name" value="{{name}}" required auto-validate></paper-input>
            </div>
            <div class="container">
                <gold-email-input label="Email ID" id="registermail" class="flex" error-message="Please enter your email, Ex: abc@xyz.com" value="{{mail}}" required auto-validate></gold-email-input>
            </div>
            <div class="container">
                <paper-input label="Address" id="registeraddress" class="flex" value="{{address}}"></paper-input>
            </div>
            <div class="container">
                <paper-input label="Mobile" id="registermobile" auto-validate allowed-pattern="[0-9]" char-counter maxlength="10" minlength="10" error-message="Please enter correct mobile number" class="flex" value="{{mobile}}" required auto-validate></paper-input>
            </div>
            <div class="container">
                <paper-button class="okButton" id="registerbutton" on-click="getonboard">Get On Board</paper-button>
            </div>
        </paper-material>
        <paper-dialog id="createtest_waitDialog" entry-animation="scale-up-animation" exit-animation="fade-out-animation" with-backdrop modal>
            <div class="centerfield">
                <paper-spinner id="loadingspinner" active></paper-spinner>
                Please wait ...
            </div>
        </paper-dialog>
        <paper-dialog style="border: 3px solid #3F51B5;" class="size-position" id="registerdialog" entry-animation="scale-up-animation" exit-animation="fade-out-animation" with-backdrop>
            <div style="height:20%;width:80%;">
                <div class="title">
                    <h1>Welcome aboard</h1>
                </div>
                <div>
                    <p>Your details are submitted. Our team will contact you to let you know how StudySolo can help you in studies.</p>
                </div>
            </div>
            <div class="buttons">
                <paper-button dialog-confirm autofocus class="okButton">OK</paper-button>
            </div>
        </paper-dialog>
        <!-- For posting the create test starts here -->
        <iron-ajax id="createlead_ironajax" url="/api/leads" handle-as="json" content-type='application/json' method="POST" body="{{createlead_postbody}}" on-response="_createleadonResponse" on-error="_createleadonError"></iron-ajax>
        <!-- For posting the create test ends here -->
    </template>
    <script>
    (function() {
        'use strict';

        Polymer({
            is: 'leads-element',

            properties: {
                createlead_postbody: {
                    type: Object,
                    notify: true
                },
                address: {
                    type: String,
                    notify: true
                },
                mobile: {
                    type: String,
                    notify: true
                },
                name: {
                    type: String,
                    notify: true
                },
                mail: {
                    type: String,
                    notify: true
                }
            },

            validate: function(value) {
                return !value;
            },

            signin: function() {
                window.location.href = "/signin";
            },

            getonboard: function() {
                var studentname = document.getElementById('registername').value;
                var studentmail = document.getElementById('registermail').value;
                var studentaddress = document.getElementById('registeraddress').value;
                var studentmobile = document.getElementById('registermobile').value;


                if ((studentname == null || studentname == "") && (studentmail == null || studentmail == "")) {
                    document.getElementById('registername').validate();
                    document.getElementById('registermail').validate();
                } else if (studentname == null || studentname == "") {
                    document.getElementById('registername').validate();
                } else if (studentmail == null || studentmail == "") {
                    document.getElementById('registermail').validate();
                } else if ((studentmobile.length == 0)||(studentmobile.length > 0 && studentmobile.length != 10)) {
                    document.getElementById('registermobile').validate();
                } else {
                    this._createLead();
                }
            },
            _createLead: function() {
                this.$.createtest_waitDialog.open();
                this.setParams();
                this.$.createlead_ironajax.generateRequest();

            },
            setParams: function() {
                this.createlead_postbody = {
                    "name": this.name,
                    "email": this.mail,
                    "address": this.address,
                    "mobileno": this.mobile
                };
            },
            _createleadonResponse: function() {
                this.$.createtest_waitDialog.close();
                var tempResponse = this.$.createlead_ironajax.lastResponse;
                if (tempResponse != null && typeof tempResponse != undefined) {
                    this.name="";
                    this.mail="";
                    this.address="";
                    this.mobile="";
                    var dialog = document.getElementById('registerdialog');
                    if (dialog)
                        dialog.open();
                } else {
                    alert("Something went wrong please retry");
                }

            },
            _createleadonError: function() {
                this.$.createtest_waitDialog.close();
                alert("Something went wrong please retry");

            }

        });
    })();

    //&& this.registermail !== null && this.registeraddress !== null
    </script>
</dom-module>
